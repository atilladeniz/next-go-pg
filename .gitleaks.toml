# Gitleaks Configuration
# https://github.com/gitleaks/gitleaks

title = "GocaTest Security Rules"

[extend]
# Use default gitleaks rules as base
useDefault = true

# Custom rules for this project
[[rules]]
id = "absolute-path-username"
description = "Absolute path containing username"
regex = '''/Users/[a-zA-Z0-9_-]+/|/home/[a-zA-Z0-9_-]+/|C:\\Users\\[a-zA-Z0-9_-]+\\'''
tags = ["path", "privacy"]

[[rules]]
id = "better-auth-secret"
description = "Better Auth Secret exposed"
regex = '''BETTER_AUTH_SECRET\s*=\s*["']?[a-zA-Z0-9+/=]{32,}["']?'''
tags = ["secret", "auth"]

[[rules]]
id = "database-url-with-password"
description = "Database URL with real credentials (not localhost dev)"
regex = '''postgres(ql)?://[^:]+:[^@]+@[a-zA-Z][^/]+/'''
tags = ["database", "credentials"]
# Allow localhost dev URLs
[rules.allowlist]
regexes = [
    '''postgres(ql)?://[^:]+:[^@]+@localhost''',
    '''postgres(ql)?://postgres:postgres@'''
]

# Global Allowlist - generated/vendor/example files
[allowlist]
description = "Generated, vendor, and example files"
paths = [
    '''go\.sum$''',
    '''bun\.lockb$''',
    '''package-lock\.json$''',
    '''node_modules/''',
    '''frontend/src/api/endpoints/''',
    '''frontend/src/api/models/''',
    '''backend/docs/swagger\.json$''',
    '''backend/docs/swagger\.yaml$''',
    '''\.env\.example$''',
    '''secrets\.example$''',
    '''\.docs/.*\.xml$'''
]
